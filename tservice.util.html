<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tservice.util documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Tservice</span> <span class="project-version">0.5.5</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tservice</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-3 branch"><a href="tservice.api.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></div></li><li class="depth-4"><a href="tservice.api.data.csv.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>csv</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.plugin.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></div></li><li class="depth-4"><a href="tservice.api.schema.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.storage.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>storage</span></div></a></li><li class="depth-4"><a href="tservice.api.storage.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.task.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="tservice.config.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="tservice.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3 branch"><a href="tservice.db.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="tservice.db.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3"><a href="tservice.db.sql-helper.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sql-helper</span></div></a></li><li class="depth-2 branch"><a href="tservice.dev-middleware.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>dev-middleware</span></div></a></li><li class="depth-2 branch"><a href="tservice.env.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>env</span></div></a></li><li class="depth-2 branch"><a href="tservice.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="tservice.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-3 branch"><a href="tservice.lib.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-3"><a href="tservice.lib.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-2"><a href="tservice.middleware.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="tservice.middleware.exception.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exception</span></div></a></li><li class="depth-3"><a href="tservice.middleware.formats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formats</span></div></a></li><li class="depth-2 branch"><a href="tservice.nrepl.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>nrepl</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin-jars.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-jars</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugins</span></div></div></li><li class="depth-3 branch"><a href="tservice.plugins.classloader.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classloader</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.dependencies.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dependencies</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.init-steps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>init-steps</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.initialize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>initialize</span></div></a></li><li class="depth-3"><a href="tservice.plugins.plugin-proxy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-proxy</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="tservice.routes.services.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>services</span></div></a></li><li class="depth-3 branch"><a href="tservice.routes.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3"><a href="tservice.routes.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-2 branch"><a href="tservice.setup.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>setup</span></div></a></li><li class="depth-2"><a href="tservice.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.task.sync-tasks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-tasks</span></div></a></li><li class="depth-2 branch current"><a href="tservice.util.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vendor</span></div></div></li><li class="depth-3"><a href="tservice.vendor.multiqc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>multiqc</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -1447px;"><span class="top" style="height: 1456px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tservice.util.html#var-call"><div class="inner"><span>call</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-datetime"><div class="inner"><span>datetime</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-deep-merge"><div class="inner"><span>deep-merge</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-delete-recursively"><div class="inner"><span>delete-recursively</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-format-color"><div class="inner"><span>format-color</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-join-path"><div class="inner"><span>join-path</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-merge-diff-map"><div class="inner"><span>merge-diff-map</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-now"><div class="inner"><span>now</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-one-or-many"><div class="inner"><span>one-or-many</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-prog1"><div class="inner"><span>prog1</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-rand-str"><div class="inner"><span>rand-str</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-replace-path"><div class="inner"><span>replace-path</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-time-.3Eint"><div class="inner"><span>time-&gt;int</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-tservice-namespace-symbols"><div class="inner"><span>tservice-namespace-symbols</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-unzip-file"><div class="inner"><span>unzip-file</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-uuid"><div class="inner"><span>uuid</span></div></a></li><li class="depth-1"><a href="tservice.util.html#var-varargs"><div class="inner"><span>varargs</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tservice.util</h1><div class="doc"><pre class="plaintext">Common utility functions useful throughout the codebase.
</pre></div><div class="public anchor" id="var-call"><h3>call</h3><div class="usage"><code>(call this &amp; that)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L138">view source</a></div></div><div class="public anchor" id="var-datetime"><h3>datetime</h3><div class="usage"><code>(datetime)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L127">view source</a></div></div><div class="public anchor" id="var-deep-merge"><h3>deep-merge</h3><div class="usage"><code>(deep-merge v &amp; vs)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L179">view source</a></div></div><div class="public anchor" id="var-delete-recursively"><h3>delete-recursively</h3><div class="usage"><code>(delete-recursively fname)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L106">view source</a></div></div><div class="public anchor" id="var-format-color"><h3>format-color</h3><div class="usage"><code>(format-color color x)</code><code>(format-color color format-string &amp; args)</code></div><div class="doc"><pre class="plaintext">Like `format`, but colorizes the output. `color` should be a symbol or keyword like `green`, `red`, `yellow`, `blue`,
`cyan`, `magenta`, etc. See the entire list of avaliable
colors [here](<a href="https://github.com/ibdknox/colorize/blob/master/src/colorize/core.clj)">https://github.com/ibdknox/colorize/blob/master/src/colorize/core.clj)</a>.

    (format-color :red "Fatal error: %s" error-message)</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L40">view source</a></div></div><div class="public anchor" id="var-join-path"><h3>join-path</h3><div class="usage"><code>(join-path root path)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L100">view source</a></div></div><div class="public anchor" id="var-merge-diff-map"><h3>merge-diff-map</h3><div class="usage"><code>(merge-diff-map old-map default-map)</code></div><div class="doc"><pre class="plaintext">Insert into the old-map when it doesn't contains a key in default map.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L117">view source</a></div></div><div class="public anchor" id="var-now"><h3>now</h3><div class="usage"><code>(now offset)</code><code>(now)</code></div><div class="doc"><pre class="plaintext">Get the current local datetime.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L132">view source</a></div></div><div class="public anchor" id="var-one-or-many"><h3>one-or-many</h3><div class="usage"><code>(one-or-many arg)</code></div><div class="doc"><pre class="plaintext">Wraps a single element in a sequence; returns sequences as-is. In lots of situations we'd like to accept either a
single value or a collection of values as an argument to a function, and then loop over them; rather than repeat
logic to check whether something is a collection and wrap if not everywhere, this utility function is provided for
your convenience.
  (u/one-or-many 1)     ; -&gt; [1]
  (u/one-or-many [1 2]) ; -&gt; [1 2]</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L54">view source</a></div></div><div class="public anchor" id="var-prog1"><h3>prog1</h3><h4 class="type">macro</h4><div class="usage"><code>(prog1 first-form &amp; body)</code></div><div class="doc"><pre class="plaintext">Execute `first-form`, then any other expressions in `body`, presumably for side-effects; return the result of
`first-form`.
  (def numbers (atom []))
  (defn find-or-add [n]
    (or (first-index-satisfying (partial = n) @numbers)
        (prog1 (count @numbers)
          (swap! numbers conj n))))
  (find-or-add 100) -&gt; 0
  (find-or-add 200) -&gt; 1
  (find-or-add 100) -&gt; 0
 The result of `first-form` is bound to the anaphor `&lt;&gt;`, which is convenient for logging:
   (prog1 (some-expression)
     (println "RESULTS:" &lt;&gt;))
`prog1` is an anaphoric version of the traditional macro of the same name in
 [Emacs Lisp](<a href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Sequencing.html#index-prog1)">http://www.gnu.org/software/emacs/manual/html_node/elisp/Sequencing.html#index-prog1)</a>
 and [Common Lisp](<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_prog1c.htm#prog1)">http://www.lispworks.com/documentation/HyperSpec/Body/m_prog1c.htm#prog1)</a>.
Style note: Prefer `doto` when appropriate, e.g. when dealing with Java objects.</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L76">view source</a></div></div><div class="public anchor" id="var-rand-str"><h3>rand-str</h3><div class="usage"><code>(rand-str n)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L174">view source</a></div></div><div class="public anchor" id="var-replace-path"><h3>replace-path</h3><div class="usage"><code>(replace-path filepath workdir)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L164">view source</a></div></div><div class="public anchor" id="var-time-.3Eint"><h3>time-&gt;int</h3><div class="usage"><code>(time-&gt;int datetime)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L123">view source</a></div></div><div class="public anchor" id="var-tservice-namespace-symbols"><h3>tservice-namespace-symbols</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Delay to a vector of symbols of all tservice namespaces, excluding test namespaces.
This is intended for use by various routines that load related namespaces, such as task and events initialization.
Using `ns-find/find-namespaces` is fairly slow, and can take as much as half a second to iterate over the thousand
or so namespaces that are part of the tservice project; use this instead for a massive performance increase.</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L25">view source</a></div></div><div class="public anchor" id="var-unzip-file"><h3>unzip-file</h3><div class="usage"><code>(unzip-file zip-file to-dir)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L148">view source</a></div></div><div class="public anchor" id="var-uuid"><h3>uuid</h3><div class="usage"><code>(uuid)</code></div><div class="doc"><pre class="plaintext">These UUID's will be guaranteed to be unique and thread-safe regardless of clock precision or degree of concurrency.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L112">view source</a></div></div><div class="public anchor" id="var-varargs"><h3>varargs</h3><h4 class="type">macro</h4><div class="usage"><code>(varargs klass)</code><code>(varargs klass xs)</code></div><div class="doc"><pre class="plaintext">Make a properly-tagged Java interop varargs argument. This is basically the same as `into-array` but properly tags
the result.
  (u/varargs String)
  (u/varargs String ["A" "B"])</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.5/src/tservice/util.clj#L66">view source</a></div></div></div></body></html>