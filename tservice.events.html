<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tservice.events documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Tservice</span> <span class="project-version">0.5.4</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tservice</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-3 branch"><a href="tservice.api.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></div></li><li class="depth-4"><a href="tservice.api.data.csv.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>csv</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.plugin.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></div></li><li class="depth-4"><a href="tservice.api.schema.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.storage.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>storage</span></div></a></li><li class="depth-4"><a href="tservice.api.storage.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.task.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="tservice.config.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="tservice.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3 branch"><a href="tservice.db.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="tservice.db.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3"><a href="tservice.db.sql-helper.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sql-helper</span></div></a></li><li class="depth-2 branch"><a href="tservice.dev-middleware.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>dev-middleware</span></div></a></li><li class="depth-2 branch"><a href="tservice.env.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>env</span></div></a></li><li class="depth-2 branch current"><a href="tservice.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="tservice.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-3 branch"><a href="tservice.lib.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-3"><a href="tservice.lib.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-2"><a href="tservice.middleware.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="tservice.middleware.exception.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exception</span></div></a></li><li class="depth-3"><a href="tservice.middleware.formats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formats</span></div></a></li><li class="depth-2 branch"><a href="tservice.nrepl.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>nrepl</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin-jars.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-jars</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugins</span></div></div></li><li class="depth-3 branch"><a href="tservice.plugins.classloader.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classloader</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.dependencies.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dependencies</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.init-steps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>init-steps</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.initialize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>initialize</span></div></a></li><li class="depth-3"><a href="tservice.plugins.plugin-proxy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-proxy</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="tservice.routes.services.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>services</span></div></a></li><li class="depth-3 branch"><a href="tservice.routes.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3"><a href="tservice.routes.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-2 branch"><a href="tservice.setup.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>setup</span></div></a></li><li class="depth-2"><a href="tservice.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.task.sync-tasks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-tasks</span></div></a></li><li class="depth-2 branch"><a href="tservice.util.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vendor</span></div></div></li><li class="depth-3"><a href="tservice.vendor.multiqc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>multiqc</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -1447px;"><span class="top" style="height: 1456px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tservice.events.html#var-initialize-events.21"><div class="inner"><span>initialize-events!</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-object-.3Emodel-id"><div class="inner"><span>object-&gt;model-id</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-object-.3Euser-id"><div class="inner"><span>object-&gt;user-id</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-publish-event.21"><div class="inner"><span>publish-event!</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-start-event-listener.21"><div class="inner"><span>start-event-listener!</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-stop-events.21"><div class="inner"><span>stop-events!</span></div></a></li><li class="depth-1"><a href="tservice.events.html#var-topic-.3Emodel"><div class="inner"><span>topic-&gt;model</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tservice.events</h1><div class="doc"><pre class="plaintext">Provides a very simply event bus using `core.async` to allow publishing and subscribing to interesting topics
happening throughout the tservice system in a decoupled way.

## Regarding Events Initialization:

The most appropriate way to initialize event listeners in any `tservice.events.*` namespace is to implement the
`events-init` function which accepts zero arguments. This function is dynamically resolved and called exactly once
when the application goes through normal startup procedures. Inside this function you can do any work needed and add
your events subscribers to the bus as usual via `start-event-listener!`.</pre></div><div class="public anchor" id="var-initialize-events.21"><h3>initialize-events!</h3><div class="usage"><code>(initialize-events!)</code></div><div class="doc"><pre class="plaintext">Initialize the asynchronous internal events system.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L50">view source</a></div></div><div class="public anchor" id="var-object-.3Emodel-id"><h3>object-&gt;model-id</h3><div class="usage"><code>(object-&gt;model-id topic object)</code></div><div class="doc"><pre class="plaintext">Determine the appropriate `model_id` (if possible) for a given OBJECT.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L124">view source</a></div></div><div class="public anchor" id="var-object-.3Euser-id"><h3>object-&gt;user-id</h3><div class="usage"><code>(object-&gt;user-id object)</code></div><div class="doc"><pre class="plaintext">Determine the appropriate `user_id` (if possible) for a given OBJECT.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L132">view source</a></div></div><div class="public anchor" id="var-publish-event.21"><h3>publish-event!</h3><div class="usage"><code>(publish-event! topic event-item)</code></div><div class="doc"><pre class="plaintext">Publish an item into the events stream. Returns the published item to allow for chaining.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L76">view source</a></div></div><div class="public anchor" id="var-start-event-listener.21"><h3>start-event-listener!</h3><div class="usage"><code>(start-event-listener! topics channel handler-fn)</code></div><div class="doc"><pre class="plaintext">Initialize an event listener which runs on a background thread via `go-loop`.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L101">view source</a></div></div><div class="public anchor" id="var-stop-events.21"><h3>stop-events!</h3><div class="usage"><code>(stop-events!)</code></div><div class="doc"><pre class="plaintext">Stop our events system.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L58">view source</a></div></div><div class="public anchor" id="var-topic-.3Emodel"><h3>topic-&gt;model</h3><div class="usage"><code>(topic-&gt;model topic)</code></div><div class="doc"><pre class="plaintext">Determine a valid `model` identifier for the given TOPIC.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.4/src/tservice/events.clj#L118">view source</a></div></div></div></body></html>