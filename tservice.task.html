<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tservice.task documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Tservice</span> <span class="project-version">0.5.6</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tservice</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-3 branch"><a href="tservice.api.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></div></li><li class="depth-4"><a href="tservice.api.data.csv.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>csv</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.plugin.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></div></li><li class="depth-4"><a href="tservice.api.schema.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.storage.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>storage</span></div></a></li><li class="depth-4"><a href="tservice.api.storage.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-3 branch"><a href="tservice.api.task.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.api.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="tservice.config.html"><div class="inner"><span class="tree" style="top: -331px;"><span class="top" style="height: 340px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="tservice.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3 branch"><a href="tservice.db.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="tservice.db.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3"><a href="tservice.db.sql-helper.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sql-helper</span></div></a></li><li class="depth-2 branch"><a href="tservice.dev-middleware.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>dev-middleware</span></div></a></li><li class="depth-2 branch"><a href="tservice.env.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>env</span></div></a></li><li class="depth-2 branch"><a href="tservice.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="tservice.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-3 branch"><a href="tservice.lib.files.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>files</span></div></a></li><li class="depth-3"><a href="tservice.lib.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-2"><a href="tservice.middleware.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="tservice.middleware.exception.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exception</span></div></a></li><li class="depth-3"><a href="tservice.middleware.formats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formats</span></div></a></li><li class="depth-2 branch"><a href="tservice.nrepl.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>nrepl</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin</span></div></a></li><li class="depth-2 branch"><a href="tservice.plugin-jars.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-jars</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugins</span></div></div></li><li class="depth-3 branch"><a href="tservice.plugins.classloader.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classloader</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.dependencies.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dependencies</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.init-steps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>init-steps</span></div></a></li><li class="depth-3 branch"><a href="tservice.plugins.initialize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>initialize</span></div></a></li><li class="depth-3"><a href="tservice.plugins.plugin-proxy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plugin-proxy</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>routes</span></div></div></li><li class="depth-3 branch"><a href="tservice.routes.services.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>services</span></div></a></li><li class="depth-3 branch"><a href="tservice.routes.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3"><a href="tservice.routes.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-2 branch"><a href="tservice.setup.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>setup</span></div></a></li><li class="depth-2 current"><a href="tservice.task.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task</span></div></a></li><li class="depth-3"><a href="tservice.task.sync-tasks.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync-tasks</span></div></a></li><li class="depth-2 branch"><a href="tservice.util.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vendor</span></div></div></li><li class="depth-3"><a href="tservice.vendor.multiqc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>multiqc</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -1447px;"><span class="top" style="height: 1456px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tservice.task.html#var-add-job.21"><div class="inner"><span>add-job!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-add-trigger.21"><div class="inner"><span>add-trigger!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-delete-task.21"><div class="inner"><span>delete-task!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-delete-trigger.21"><div class="inner"><span>delete-trigger!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-init.21"><div class="inner"><span>init!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-schedule-task.21"><div class="inner"><span>schedule-task!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-scheduler-info"><div class="inner"><span>scheduler-info</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-start-scheduler.21"><div class="inner"><span>start-scheduler!</span></div></a></li><li class="depth-1"><a href="tservice.task.html#var-stop-scheduler.21"><div class="inner"><span>stop-scheduler!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tservice.task</h1><div class="doc"><pre class="plaintext">Background task scheduling via Quartzite. Individual tasks are defined in `tservice.task.*`.

## Regarding Task Initialization:

The most appropriate way to initialize tasks in any `tservice.task.*` namespace is to implement the `task-init`
function which accepts zero arguments. This function is dynamically resolved and called exactly once when the
application goes through normal startup procedures. Inside this function you can do any work needed and add your
task to the scheduler as usual via `schedule-task!`.

## Quartz JavaDoc

Find the JavaDoc for Quartz here: <a href="http://www.quartz-scheduler.org/api/2.3.0/index.html">http://www.quartz-scheduler.org/api/2.3.0/index.html</a></pre></div><div class="public anchor" id="var-add-job.21"><h3>add-job!</h3><div class="usage"><code>(add-job! job)</code></div><div class="doc"><pre class="plaintext">Inputs: [job :- JobDetail]

Add a job separately from a trigger, replace if the job is already there</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L184">view source</a></div></div><div class="public anchor" id="var-add-trigger.21"><h3>add-trigger!</h3><div class="usage"><code>(add-trigger! trigger)</code></div><div class="doc"><pre class="plaintext">Inputs: [trigger :- Trigger]

Add a trigger. Assumes the trigger is already associated to a job (i.e. `trigger/for-job`)</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L190">view source</a></div></div><div class="public anchor" id="var-delete-task.21"><h3>delete-task!</h3><div class="usage"><code>(delete-task! job-key trigger-key)</code></div><div class="doc"><pre class="plaintext">Inputs: [job-key :- JobKey trigger-key :- TriggerKey]

delete a task from the scheduler</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L177">view source</a></div></div><div class="public anchor" id="var-delete-trigger.21"><h3>delete-trigger!</h3><div class="usage"><code>(delete-trigger! trigger-key)</code></div><div class="doc"><pre class="plaintext">Inputs: [trigger-key :- TriggerKey]

Remove `trigger-key` from the scheduler</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L196">view source</a></div></div><div class="public anchor" id="var-init.21"><h3>init!</h3><h4 class="type">multimethod</h4><div class="usage"><code>(init! job-name-string)</code></div><div class="doc"><pre class="plaintext">Initialize (i.e., schedule) Job(s) with a given name. All implementations of this method are called once and only
once when the Quartz task scheduler is initialized. Task namespaces (`tservice.task.*`) should add new
implementations of this method to schedule the jobs they define (i.e., with a call to `schedule-task!`.)

The dispatch value for this function can be any unique keyword, but by convention is a namespaced keyword version of
the name of the Job being initialized; for sake of consistency with the Job name itself, the keyword should be left
CamelCased.

  (defmethod task/init! ::SendPulses [_]
    (task/schedule-task! my-job my-trigger))</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L45">view source</a></div></div><div class="public anchor" id="var-schedule-task.21"><h3>schedule-task!</h3><div class="usage"><code>(schedule-task! job trigger)</code></div><div class="doc"><pre class="plaintext">Inputs: [job :- JobDetail trigger :- Trigger]

Add a given job and trigger to our scheduler.</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L167">view source</a></div></div><div class="public anchor" id="var-scheduler-info"><h3>scheduler-info</h3><div class="usage"><code>(scheduler-info)</code></div><div class="doc"><pre class="plaintext">Return raw data about all the scheduler and scheduled tasks (i.e. Jobs and Triggers). Primarily for debugging
purposes.</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L245">view source</a></div></div><div class="public anchor" id="var-start-scheduler.21"><h3>start-scheduler!</h3><div class="usage"><code>(start-scheduler!)</code></div><div class="doc"><pre class="plaintext">Start our Quartzite scheduler which allows jobs to be submitted and triggers to begin executing.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L133">view source</a></div></div><div class="public anchor" id="var-stop-scheduler.21"><h3>stop-scheduler!</h3><div class="usage"><code>(stop-scheduler!)</code></div><div class="doc"><pre class="plaintext">Stop our Quartzite scheduler and shutdown any running executions.
</pre></div><div class="src-link"><a href="https://github.com/clinico-omics/tservice/blob/v0.5.6/src/tservice/task.clj#L145">view source</a></div></div></div></body></html>